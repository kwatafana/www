<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jackson G. Kaindume https://kwatafana.org/" />
  <meta name="dcterms.date" content="2022-09-06" />
  <title>Guix notes</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <style type="text/css">html {
line-height: 1.5;
font-family: Georgia, serif;
font-size: 20px;
color: cyan;
background-color: #222D31;
}
.title{
font-size: 1.5em;
font-weight: bolder;
}
body {
margin: 0 auto;
max-width: 36em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
word-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 1em;
}
}
@media print {
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
a {
color: cyan;
}
a:visited {
color: cyan;
}
img {
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 1px dashed #606060;
color: #606060;
font-size: .6em;
}
code {
font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
font-size: 85%;
margin: 0;
color: teal;
border: thin dashed teal;
border-radius: 2px;
}
pre {
margin: 1em 0;
overflow: auto;
border: thin dashed teal;
border-radius: 2px;
padding: .5em;
}
pre code {
padding: 0;
overflow: visible;
border: none;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
hr {
background-color: teal;
border: none;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
}
tbody, tr, td{
border: 1px solid teal;
}
th {
padding: 0.25em 0.5em 0.25em 0.5em;
border: 2px solid teal;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC a:not(:hover) {
text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}
</style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Guix notes</h1>
<p class="author">Jackson G. Kaindume <a href="https://kwatafana.org/" class="uri">https://kwatafana.org/</a></p>
<p class="date">2022-09-06</p>
</header>
<nav id="TOC" role="doc-toc">
<ul class="incremental">
<li><a href="#store">üåã Store</a></li>
<li><a href="#profiles">‚≠êÔ∏è Profiles</a></li>
<li><a href="#daemon">üëπ Daemon</a></li>
<li><a href="#guix-files">üìï Guix files</a></li>
<li><a href="#offloading-and-substitutes">‚ö°Ô∏è Offloading and Substitutes</a>
<ul class="incremental">
<li><a href="#offloading">Offloading</a></li>
<li><a href="#substitutes">Substitutes</a></li>
</ul></li>
<li><a href="#commands">ü™Ñ Commands</a>
<ul class="incremental">
<li><a href="#pull">pull</a></li>
<li><a href="#search">search</a></li>
<li><a href="#install">install</a></li>
<li><a href="#list-installed">list installed</a></li>
<li><a href="#roll-back">roll back</a></li>
<li><a href="#generations">generations</a></li>
<li><a href="#help--h">help (-h)</a></li>
</ul></li>
</ul>
</nav>
<hr />
<h2 id="store">üåã Store</h2>
<p>Installed packages are stored in the store /gnu/store. All packages installed with <code>guix install</code> by any user is stored there.</p>
<p>Each package is stored in its own directory with such a name <code>/gnu/store/xxx-package-1.2</code> the xxx is a base32 encoded hash of all the inputs that were used to build that package‚Äîcompiler, libraries, build scripts.</p>
<p>The same package with different versions can exist in the store. Packages can be garbage collected and guix knows which packages are not used by any users and safe to garbage collect.</p>
<h2 id="profiles">‚≠êÔ∏è Profiles</h2>
<p>Users profile map packages in the store to a user that installed the package.</p>
<h2 id="daemon">üëπ Daemon</h2>
<p>At the heart of <a href="https://guix.gnu.org/">guix</a> is the <a href="https://guix.gnu.org/en/manual/devel/en/guix.html#Invoking-guix_002ddaemon">daemon</a> which is simply a computer program that runs as a background process.</p>
<p>The daemon is the only one allowed to access the store, clients that wish to access the store do this by passing RPC commands to the daemon.</p>
<p>This daemon is responsible for the following operations:</p>
<ul class="incremental">
<li>üî• <a href>Package Building</a></li>
<li>üßØ <a href>Garbage Collection</a></li>
</ul>
<h2 id="guix-files">üìï Guix files</h2>
<p>Mapped from the Guix package manager install on Debian 11.</p>
<table>
<colgroup>
<col style="width: 29%"></col>
<col style="width: 70%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Path</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>/usr/local/bin/guix</code></td>
<td>Guix binary</td>
</tr>
<tr class="even">
<td><code>/gnu/store</code></td>
<td>Guix package store</td>
</tr>
<tr class="odd">
<td><code>/etc/guix/machines.scm</code></td>
<td>user-specified build machines for offload derivation builds</td>
</tr>
<tr class="even">
<td><code>etc/guix-daemon.cil</code></td>
<td>SELinux policy file</td>
</tr>
<tr class="odd">
<td><code>~/.guix-profile</code></td>
<td>User profiles</td>
</tr>
</tbody>
</table>
<h2 id="offloading-and-substitutes">‚ö°Ô∏è Offloading and Substitutes</h2>
<h3 id="offloading">Offloading</h3>
<p>The daemon can offload package builds to other machines depending on supported architectures and other criteria. A list of machines should be specified in the <code>/etc/guix/machines.scm</code> file. Here is an example of that, copied from the <a href="https://guix.gnu.org/en/manual/devel/en/guix.html#Daemon-Offload-Setup">Guix docs</a>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode guile"><code class="sourceCode scheme"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>(<span class="kw">list</span> (build-machine</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>    (name <span class="st">&quot;eightysix.example.org&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>    (systems (<span class="kw">list</span> <span class="st">&quot;x86_64-linux&quot;</span> <span class="st">&quot;i686-linux&quot;</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>    (host-key <span class="st">&quot;ssh-ed25519 AAAAC3Nza‚Ä¶&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a>    (user <span class="st">&quot;bob&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a>    (speed <span class="fl">2.</span>))     <span class="co">;incredibly fast!</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>    </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a>    (build-machine</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>        (name <span class="st">&quot;armeight.example.org&quot;</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>        (systems (<span class="kw">list</span> <span class="st">&quot;aarch64-linux&quot;</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a>        (host-key <span class="st">&quot;ssh-rsa AAAAB3Nza‚Ä¶&quot;</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a>        (user <span class="st">&quot;alice&quot;</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a>        </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a>        <span class="co">;; Remember &#39;guix offload&#39; is spawned by</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a>        <span class="co">;; &#39;guix-daemon&#39; as root.</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a>        (private-key <span class="st">&quot;/root/.ssh/identity-for-guix&quot;</span>)))</span></code></pre></div>
<h3 id="substitutes">Substitutes</h3>
<p><a href="https://guix.gnu.org/en/manual/devel/en/guix.html#Substitutes" class="uri">https://guix.gnu.org/en/manual/devel/en/guix.html#Substitutes</a></p>
<hr />
<h2 id="commands">ü™Ñ Commands</h2>
<h3 id="pull">pull</h3>
<p>Pull the latest revision of Guix and its package collection:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="ex">guix</span> pull</span></code></pre></div>
<p>Then instruct shell to point to latest pulled guix revision:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="bu">hash</span> guix</span></code></pre></div>
<p>Then upgrade all packages previously installed:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="ex">guix</span> upgrade</span></code></pre></div>
<h3 id="search">search</h3>
<p>Search for packages:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="ex">guix</span> search text editor</span></code></pre></div>
<h3 id="install">install</h3>
<p>Install a package:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="ex">guix</span> install emacs</span></code></pre></div>
<h3 id="list-installed">list installed</h3>
<p>List installed packages:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="ex">guix</span> package --list-installed</span></code></pre></div>
<h3 id="roll-back">roll back</h3>
<p>Roll back unwanted changes (installs, removals, upgrades)</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="ex">guix</span> package --roll-back</span></code></pre></div>
<h3 id="generations">generations</h3>
<p>List package transaction history</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="ex">guix</span> package --list-generations</span></code></pre></div>
<h3 id="help--h">help (-h)</h3>
<pre class="console"><code>Usage: guix COMMAND ARGS...
Run COMMAND with ARGS.

COMMAND must be one of the sub-commands listed below:

  main commands
    deploy        deploy operating systems on a set of machines
    describe      describe the channel revisions currently used
    gc            invoke the garbage collector
    install       install packages
    package       manage packages and profiles
    pull          pull the latest revision of Guix
    remove        remove installed packages
    search        search for packages
    show          show information about packages
    system        build and deploy full operating systems
    time-machine  run commands from a different revision
    upgrade       upgrade packages to their latest version
    weather       report on the availability of pre-built package binaries

  software development commands
    container    run code in containers created by &#39;guix environment -C&#39;
    environment  spawn one-off software environments
    pack         create application bundles

  packaging commands
    build      build packages or derivations without installing them
    challenge  challenge substitute servers, comparing their binaries
    download   download a file to the store and print its hash
    edit       view and edit package definitions
    graph      view and query package dependency graphs
    hash       compute the cryptographic hash of a file
    import     import a package definition from an external repository
    lint       validate package definitions
    publish    publish build results over HTTP
    refresh    update existing package definitions
    size       profile the on-disk size of packages

  plumbing commands
    archive    manipulate, export, and import normalized archives (nars)
    copy       copy store items remotely over SSH
    git        operate on Git repositories
    offload    set up and operate build offloading
    processes  list currently running sessions
    repl       read-eval-print loop (REPL) for interactive programming

Report bugs to: bug-guix@gnu.org.
GNU Guix home page: &lt;https://www.gnu.org/software/guix/&gt;
General help using Guix and GNU software: &lt;https://guix.gnu.org/en/help/&gt;
                                                                                                                                            General help using Guix and GNU software: &lt;https://guix.gnu.org</code></pre>
<hr>
‚ßâ <a href="../index.html">kwatafana.org</a> | <em> <b>email: kaindume (at) kwatafana (dot) org</b> </em> <br>
<div style="text-align: right">
<p><small><em>updated: 2022-09-22 15:17:26.967664620 UTC</small></p>
</div>
</body>
</html>
