<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Cyber Offense</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="h4.html">h4</a></li><li class="chapter-item expanded "><a href="methodology.html"><strong aria-hidden="true">1.</strong> Methodology</a></li><li class="chapter-item expanded "><a href="apache.html"><strong aria-hidden="true">2.</strong> Apache</a></li><li class="chapter-item expanded "><a href="hackthissite.html"><strong aria-hidden="true">3.</strong> hackthissite</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="analysis.html">System Analysis Template</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Cyber Offense</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="h4"><a class="header" href="#h4">h4</a></h1>
<p><code>h4</code> is a multi-purpose tool for testing the security of HTTP web 
servers.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="methodology"><a class="header" href="#methodology">Methodology</a></h1>
<h2 id="cia-data-control"><a class="header" href="#cia-data-control">CIA Data control</a></h2>
<p>Hacking is fundamentally about data control, controlling the data on 
a webpage, in a database, cookie or data sitting on a webserver out
there somewhere in the cloud.</p>
<p>For a hacker controlling the data means compromising:</p>
<ol>
<li><strong>C</strong>onfidentiality: being able to <strong>read</strong> data it in cleartext</li>
<li><strong>I</strong>ntegrity: being able to <strong>modify</strong> the data</li>
<li><strong>A</strong>vailability: being able to <strong>destroy</strong> the data</li>
</ol>
<h3 id="1-doorways-inputs"><a class="header" href="#1-doorways-inputs">1. Doorways (Inputs)</a></h3>
<p>A hacker needs to find avenues to meet the system, these are avenues 
where the hacker gets the system to run and hopefully get it to crush 
and burn.</p>
<p>The best way to find avenues is through the inputs of the system, 
these are the doorways the system has to the outside world. Naive 
systems fail to consider all that can pass through those doorways, the
same door that fits the angel also fits the demon.</p>
<p>It is good practice to decompose a system or sub-system to it doorways
(Inputs) and analyze the angels (expected input) and demons (hacker
input).</p>
<h3 id="2-angels-expected-inputs"><a class="header" href="#2-angels-expected-inputs">2. Angels (Expected Inputs)</a></h3>
<p>These are the inputs expected by a system.</p>
<h3 id="3-demons"><a class="header" href="#3-demons">3. Demons</a></h3>
<p>These are the inputs not considered by naive systems. These inputs can
result in the compromise of the systems <strong>confidentiality</strong>, 
<strong>integrity</strong> or <strong>availability</strong>.</p>
<h3 id="4-bugs"><a class="header" href="#4-bugs">4. Bugs</a></h3>
<p>Some hacks are as the result of vulnerable software dependencies of 
developer/implementation bugs such as CVEs, these bugs can lead to 
angels and demons doorways or to other class of <em>CIA data control</em> 
hacks.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="apache"><a class="header" href="#apache">Apache</a></h1>
<blockquote>
<p>The Apache HTTP Server Project is an effort to develop and maintain 
an open-source HTTP server for modern operating systems including 
UNIX and Windows. The goal of this project is to provide a secure, 
efficient and extensible server that provides HTTP services in sync 
with the current HTTP standards.</p>
</blockquote>
<blockquote>
<p>The Apache HTTP Server (&quot;httpd&quot;) was launched in 1995 and it has 
been the most popular web server on the Internet since April 1996. 
It has celebrated its 25th birthday as a project in February 2020.</p>
</blockquote>
<h2 id="ref"><a class="header" href="#ref">Ref</a></h2>
<ul>
<li><a href="https://www.feistyduck.com/library/apache-security/online/index.html">https://www.feistyduck.com/library/apache-security/online/index.html</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hack-this-site"><a class="header" href="#hack-this-site">Hack This Site</a></h1>
<h2 id="realistic"><a class="header" href="#realistic">Realistic</a></h2>
<ol>
<li><a href="https://www.hackthissite.org/missions/realistic/1/index.php">Difficulty rating: Easy</a></li>
</ol>
<blockquote>
<p>From: HeavyMetalRyan</p>
<p>Message: Hey man, I need a big favour from you. Remember that 
website I showed you once before? Uncle Arnold's Band Review Page? 
Well, a long time ago I made a $500 bet with a friend that my band 
would be at the top of the list by the end of the year. Well, as 
you already know, two of my band members have died in a horrendous 
car accident... but this ass hole still insists that the bet is on!
I know you're good with computers and stuff, so I was wondering, is 
there any way for you to hack this website and make my band on the 
top of the list? My band is Raging Inferno. Thanks a lot, man!</p>
</blockquote>
<p>If we visit the challenge's <a href="https://www.hackthissite.org/missions/realistic/1/index.php">webpage</a>
we see a page. The interesting parts of the page are the 5 sections
of the 5 bands, the bands are ordered the top to bottom with the best
band being on top and the worst being at the bottom of the list.</p>
<p>Each section contains an HTML form, here is the form for the top band
(Imposing Republic):</p>
<pre><code class="language-html">&lt;form action=&quot;v.php&quot; method=&quot;get&quot;&gt;
	&lt;input type=&quot;hidden&quot; name=&quot;PHPSESSID&quot; value=&quot;abcaeadfc31a5c43b2534bf995c0553f&quot;&gt;
	&lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;4&quot;&gt;
	&lt;select name=&quot;vote&quot;&gt;
		&lt;option value=&quot;1&quot;&gt;1&lt;/option&gt;
		&lt;option value=&quot;2&quot;&gt;2&lt;/option&gt;
		&lt;option value=&quot;3&quot;&gt;3&lt;/option&gt;
		&lt;option value=&quot;4&quot;&gt;4&lt;/option&gt;
		&lt;option value=&quot;5&quot;&gt;5&lt;/option&gt;
	&lt;/select&gt;
	&lt;input type=&quot;submit&quot; value=&quot;vote!&quot;&gt;
&lt;/form&gt;
</code></pre>
<p>The form sends a <code>GET</code> request, this means that the form data will be
appended to the URL in key/value pairs, this it looks for the first 
form:</p>
<p>&lt;/v.php?PHPSESSID=abcaeadfc31a5c43b2534bf995c0553f&amp;id=4&amp;vote=1&gt;</p>
<p>Where PHPSESSID is the session ID, id </p>
<h4 id="analysis"><a class="header" href="#analysis">Analysis</a></h4>
<h5 id="1-confidentiality"><a class="header" href="#1-confidentiality">1. Confidentiality</a></h5>
<blockquote>
<p>On this page what data should the hacker not be able to read?</p>
</blockquote>
<p>None.</p>
<h5 id="2-integrity"><a class="header" href="#2-integrity">2. Integrity</a></h5>
<blockquote>
<p>On this page what data should the hacker not be able to modify?</p>
</blockquote>
<ul>
<li>Band list order.
What controls the band list order on the page?</li>
</ul>
<h5 id="3-availability"><a class="header" href="#3-availability">3. Availability</a></h5>
<blockquote>
<p>On this page what data should the hacker not be able to destroy?</p>
</blockquote>
<ul>
<li>Bands
What controls the bands on the page?</li>
</ul>
<h5 id="4-doorways-angels-and-demons"><a class="header" href="#4-doorways-angels-and-demons">4. Doorways, Angels and Demons</a></h5>
<p>Door = GET v.php?PHPSESSID=<TOKEN>&amp;id=4&amp;vote=1</p>
<p>Angel = GET v.php?PHPSESSID=abcaeadfc31a5c43b2534bf995c0553f&amp;id=4&amp;vote=1</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="system-analysis-template"><a class="header" href="#system-analysis-template">System Analysis Template</a></h1>
<h2 id="webpage"><a class="header" href="#webpage">Webpage</a></h2>
<h3 id="1-confidentiality-1"><a class="header" href="#1-confidentiality-1">1. Confidentiality</a></h3>
<blockquote>
<p>On this page what data should the hacker not be able to read?</p>
</blockquote>
<p>If so what controls that data?</p>
<h3 id="2-integrity-1"><a class="header" href="#2-integrity-1">2. Integrity</a></h3>
<blockquote>
<p>On this page what data should the hacker not be able to modify?</p>
</blockquote>
<p>If so what controls that data?</p>
<h3 id="3-availability-1"><a class="header" href="#3-availability-1">3. Availability</a></h3>
<blockquote>
<p>On this page what data should the hacker not be able to destroy?</p>
</blockquote>
<p>If so what controls that data?</p>
<h3 id="4-doorways-angels-and-demons-1"><a class="header" href="#4-doorways-angels-and-demons-1">4. Doorways, Angels and Demons</a></h3>
<blockquote>
<p>List all the doorways on this page with their angels and demons</p>
</blockquote>
<h3 id="5-bugs"><a class="header" href="#5-bugs">5. Bugs</a></h3>
<blockquote>
<p>List exploitable dependency bugs</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
