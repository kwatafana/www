<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Update Readme - cyrtophora - Full-stack users-first, secure web framework.
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="cyrtophora Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="cyrtophora Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="/git.css" />
</head>
<body>
<table><tr><td><a href="/index.html"><img src="/logo.png" alt="" width="32" height="32" /></a></td><td><h1>cyrtophora</h1><span class="desc">Full-stack users-first, secure web framework.
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://gitlab.com/kwatafana/cyrtophora.git">https://gitlab.com/kwatafana/cyrtophora.git</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.pretty.html">README</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/6ad8192fc9070977746041abc057f874fffab6f8.html">6ad8192fc9070977746041abc057f874fffab6f8</a>
<b>parent</b> <a href="../commit/71f5ea8885f845b5bb99263345c65e409e60f2e2.html">71f5ea8885f845b5bb99263345c65e409e60f2e2</a>
<b>Author:</b> Jackson G. Kaindume &lt;<a href="mailto:kaindume@kwatafana.org">kaindume@kwatafana.org</a>&gt;
<b>Date:</b>   Thu, 22 Sep 2022 01:15:13 +0200

Update Readme

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">README.md</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">phora/src/account.rs</a></td><td> | </td><td class="num">9</td><td><span class="i">+++</span><span class="d">------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h2">phora/src/api.rs</a></td><td> | </td><td class="num">13</td><td><span class="i"></span><span class="d">-------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">phora/src/data.rs</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">phora/src/database/error.rs</a></td><td> | </td><td class="num">22</td><td><span class="i">+++++++++++</span><span class="d">-----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">phora/src/database/mod.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">phora/src/database/sqlite.rs</a></td><td> | </td><td class="num">32</td><td><span class="i">++++++++++++++++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">phora/src/lib.rs</a></td><td> | </td><td class="num">52</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">spec/book.toml</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">spec/src/SUMMARY.md</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">spec/src/cyrtophora.md</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">spec/src/password-hashing.md</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h12">spec/src/validation.md</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
</table></pre><pre>13 files changed, 104 insertions(+), 59 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/README.md.html">README.md</a> b/<a href="../file/README.md.html">README.md</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -1,6 +1,13 @@
</a> &lt;div style=&quot;text-align: right&quot;&gt;	
<a href="#h0-0-1" id="h0-0-1" class="d">-&lt;a href=&quot;https://codeberg.org/seestem/cyrtophora&quot;&gt;
</a><a href="#h0-0-2" id="h0-0-2" class="d">-    &lt;img alt=&quot;Get it on Codeberg&quot; src=&quot;https://codeberg.org/Codeberg/GetItOnCodeberg/media/branch/main/get-it-on-white-on-black.png&quot; height=&quot;60&quot;&gt;
</a><a href="#h0-0-3" id="h0-0-3" class="i">+Clone it on
</a><a href="#h0-0-4" id="h0-0-4" class="i">+&lt;a style=&quot;text-decoration: none&quot; href=&quot;https://gitlab.com/kwatafana/cyrtophora&quot;&gt;
</a><a href="#h0-0-5" id="h0-0-5" class="i">+	&lt;span style=&quot;color: #fc6d26&quot;&gt;Gitlab&lt;/span&gt;
</a><a href="#h0-0-6" id="h0-0-6" class="i">+	&lt;svg class=&quot;tanuki-logo&quot; width=&quot;25&quot; height=&quot;24&quot; viewBox=&quot;0 0 25 24&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
</a><a href="#h0-0-7" id="h0-0-7" class="i">+		&lt;path class=&quot;tanuki-shape tanuki&quot; d=&quot;m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z&quot; fill=&quot;#E24329&quot;&gt;&lt;/path&gt;
</a><a href="#h0-0-8" id="h0-0-8" class="i">+		&lt;path class=&quot;tanuki-shape right-cheek&quot; d=&quot;m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z&quot; fill=&quot;#FC6D26&quot;&gt;&lt;/path&gt;
</a><a href="#h0-0-9" id="h0-0-9" class="i">+		&lt;path class=&quot;tanuki-shape chin&quot; d=&quot;m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z&quot; fill=&quot;#FCA326&quot;&gt;&lt;/path&gt;
</a><a href="#h0-0-10" id="h0-0-10" class="i">+		&lt;path class=&quot;tanuki-shape left-cheek&quot; d=&quot;M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z&quot; fill=&quot;#FC6D26&quot;&gt;&lt;/path&gt;
</a><a href="#h0-0-11" id="h0-0-11" class="i">+	&lt;/svg&gt;
</a> &lt;/a&gt;
 &lt;/div&gt;	
 
<b>diff --git a/<a id="h1" href="../file/phora/src/account.rs.html">phora/src/account.rs</a> b/<a href="../file/phora/src/account.rs.html">phora/src/account.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -1,4 +1,4 @@
</a><a href="#h1-0-0" id="h1-0-0" class="d">-use crate::data::AccountRegistration;
</a><a href="#h1-0-1" id="h1-0-1" class="i">+use crate::data::AccountCreationInput;
</a> use crate::validate::ValidationError;
 use serde::{Deserialize, Serialize};
 
<a href="#h1-1" id="h1-1" class="h">@@ -15,19 +15,16 @@ pub struct Account {
</a> 
 impl Account {
     /// Create new account
<a href="#h1-1-3" id="h1-1-3" class="d">-    pub fn create(payload: AccountRegistration) -&gt; Result&lt;PublicAccount, ValidationError&gt; {
</a><a href="#h1-1-4" id="h1-1-4" class="i">+    pub fn create(payload: AccountCreationInput) -&gt; Result&lt;Self, ValidationError&gt; {
</a>         payload.is_valid()?;
 
<a href="#h1-1-7" id="h1-1-7" class="d">-        // TODO: email verification
</a><a href="#h1-1-8" id="h1-1-8" class="d">-        // TODO: database registration
</a><a href="#h1-1-9" id="h1-1-9" class="d">-
</a>         let account = Account {
             username: payload.username,
             email: payload.email,
             password: payload.password,
         };
 
<a href="#h1-1-16" id="h1-1-16" class="d">-        Ok(account.into())
</a><a href="#h1-1-17" id="h1-1-17" class="i">+        Ok(account)
</a>     }
 }
 
<b>diff --git a/<a id="h2" href="../file/phora/src/api.rs.html">phora/src/api.rs</a> b/<a href="../file/phora/src/api.rs.html">phora/src/api.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -1,13 +0,0 @@
</a><a href="#h2-0-0" id="h2-0-0" class="d">-pub struct API {
</a><a href="#h2-0-1" id="h2-0-1" class="d">-    pub version: String,
</a><a href="#h2-0-2" id="h2-0-2" class="d">-    pub accounts: String,
</a><a href="#h2-0-3" id="h2-0-3" class="d">-}
</a><a href="#h2-0-4" id="h2-0-4" class="d">-
</a><a href="#h2-0-5" id="h2-0-5" class="d">-impl Default for API {
</a><a href="#h2-0-6" id="h2-0-6" class="d">-    fn default() -&gt; Self {
</a><a href="#h2-0-7" id="h2-0-7" class="d">-        API {
</a><a href="#h2-0-8" id="h2-0-8" class="d">-            version: &quot;/v0&quot;.to_string(),
</a><a href="#h2-0-9" id="h2-0-9" class="d">-            accounts: &quot;/v0/accounts&quot;.to_string(),
</a><a href="#h2-0-10" id="h2-0-10" class="d">-        }
</a><a href="#h2-0-11" id="h2-0-11" class="d">-    }
</a><a href="#h2-0-12" id="h2-0-12" class="d">-}
</a><b>diff --git a/<a id="h3" href="../file/phora/src/data.rs.html">phora/src/data.rs</a> b/<a href="../file/phora/src/data.rs.html">phora/src/data.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -3,14 +3,14 @@ use serde::{Deserialize, Serialize};
</a> 
 /// User registration Data
 #[derive(Deserialize, Serialize)]
<a href="#h3-0-3" id="h3-0-3" class="d">-pub struct AccountRegistration {
</a><a href="#h3-0-4" id="h3-0-4" class="i">+pub struct AccountCreationInput {
</a>     pub username: String,
     pub password: String,
     pub retyped_password: String,
     pub email: Option&lt;String&gt;,
 }
 
<a href="#h3-0-11" id="h3-0-11" class="d">-impl AccountRegistration {
</a><a href="#h3-0-12" id="h3-0-12" class="i">+impl AccountCreationInput {
</a>     pub fn is_valid(&amp;self) -&gt; Result&lt;(), ValidationError&gt; {
         if self.password != self.retyped_password {
             return Err(ValidationError::Password);
<b>diff --git a/<a id="h4" href="../file/phora/src/database/error.rs.html">phora/src/database/error.rs</a> b/<a href="../file/phora/src/database/error.rs.html">phora/src/database/error.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -1,27 +1,27 @@
</a> use std::fmt;
 
 #[derive(Debug)]
<a href="#h4-0-3" id="h4-0-3" class="d">-pub enum DatabaseError {
</a><a href="#h4-0-4" id="h4-0-4" class="d">-    ConnectionError,
</a><a href="#h4-0-5" id="h4-0-5" class="d">-    CreateTableError,
</a><a href="#h4-0-6" id="h4-0-6" class="d">-    AccountRetrievalError,
</a><a href="#h4-0-7" id="h4-0-7" class="i">+pub enum Error {
</a><a href="#h4-0-8" id="h4-0-8" class="i">+    Connection,
</a><a href="#h4-0-9" id="h4-0-9" class="i">+    CreateTable,
</a><a href="#h4-0-10" id="h4-0-10" class="i">+    AccountRetrieval,
</a> }
 
<a href="#h4-0-13" id="h4-0-13" class="d">-impl std::error::Error for DatabaseError {}
</a><a href="#h4-0-14" id="h4-0-14" class="i">+impl std::error::Error for Error {}
</a> 
<a href="#h4-0-16" id="h4-0-16" class="d">-impl fmt::Display for DatabaseError {
</a><a href="#h4-0-17" id="h4-0-17" class="i">+impl fmt::Display for Error {
</a>     fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {
         match self {
<a href="#h4-0-20" id="h4-0-20" class="d">-            DatabaseError::ConnectionError =&gt; write!(f, &quot;Database connection error&quot;),
</a><a href="#h4-0-21" id="h4-0-21" class="d">-            DatabaseError::CreateTableError =&gt; write!(f, &quot;Could not create Sql table&quot;),
</a><a href="#h4-0-22" id="h4-0-22" class="d">-            DatabaseError::AccountRetrievalError =&gt; write!(f, &quot;Could not create retrieve account&quot;),
</a><a href="#h4-0-23" id="h4-0-23" class="i">+            Error::Connection =&gt; write!(f, &quot;Database connection error&quot;),
</a><a href="#h4-0-24" id="h4-0-24" class="i">+            Error::CreateTable =&gt; write!(f, &quot;Could not create Sql table&quot;),
</a><a href="#h4-0-25" id="h4-0-25" class="i">+            Error::AccountRetrieval =&gt; write!(f, &quot;Could not create retrieve account&quot;),
</a>         }
     }
 }
 
 #[cfg(feature = &quot;sqlite&quot;)]
<a href="#h4-0-31" id="h4-0-31" class="d">-impl From&lt;rusqlite::Error&gt; for DatabaseError {
</a><a href="#h4-0-32" id="h4-0-32" class="i">+impl From&lt;rusqlite::Error&gt; for Error {
</a>     fn from(_: rusqlite::Error) -&gt; Self {
<a href="#h4-0-34" id="h4-0-34" class="d">-        DatabaseError::ConnectionError
</a><a href="#h4-0-35" id="h4-0-35" class="i">+        Error::Connection
</a>     }
 }
<b>diff --git a/<a id="h5" href="../file/phora/src/database/mod.rs.html">phora/src/database/mod.rs</a> b/<a href="../file/phora/src/database/mod.rs.html">phora/src/database/mod.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -1,17 +1,15 @@
</a> use crate::account::{Account, PublicAccount};
<a href="#h5-0-1" id="h5-0-1" class="d">-use error::DatabaseError;
</a><a href="#h5-0-2" id="h5-0-2" class="i">+use error::Error;
</a> 
 pub mod error;
 #[cfg(feature = &quot;sqlite&quot;)]
 pub mod sqlite;
 
 pub trait DB {
<a href="#h5-0-9" id="h5-0-9" class="d">-    /// New database instance
</a><a href="#h5-0-10" id="h5-0-10" class="d">-    fn new(path: &amp;str) -&gt; Self;
</a>     /// Connect to database
<a href="#h5-0-12" id="h5-0-12" class="d">-    fn connect(&amp;mut self) -&gt; Result&lt;(), DatabaseError&gt;;
</a><a href="#h5-0-13" id="h5-0-13" class="i">+    fn connect(&amp;mut self) -&gt; Result&lt;(), Error&gt;;
</a>     /// Store user account
<a href="#h5-0-15" id="h5-0-15" class="d">-    fn store_account(&amp;self, account: Account) -&gt; Result&lt;(), DatabaseError&gt;;
</a><a href="#h5-0-16" id="h5-0-16" class="i">+    fn account_store(&amp;self, account: &amp;Account) -&gt; Result&lt;(), Error&gt;;
</a>     /// Get account public data
<a href="#h5-0-18" id="h5-0-18" class="d">-    fn get_public_account(&amp;self, username: &amp;str) -&gt; Result&lt;PublicAccount, DatabaseError&gt;;
</a><a href="#h5-0-19" id="h5-0-19" class="i">+    fn account_get_pub(&amp;self, username: &amp;str) -&gt; Result&lt;PublicAccount, Error&gt;;
</a> }
<b>diff --git a/<a id="h6" href="../file/phora/src/database/sqlite.rs.html">phora/src/database/sqlite.rs</a> b/<a href="../file/phora/src/database/sqlite.rs.html">phora/src/database/sqlite.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -1,4 +1,4 @@
</a><a href="#h6-0-0" id="h6-0-0" class="d">-use super::{error::DatabaseError, DB};
</a><a href="#h6-0-1" id="h6-0-1" class="i">+use super::{error::Error, DB};
</a> use crate::account::{Account, PublicAccount};
 use rusqlite::{params, Connection, Result};
 
<a href="#h6-1" id="h6-1" class="h">@@ -36,16 +36,16 @@ pub struct SqliteDB {
</a>     /// An SQLite connection handle
     conn: Option&lt;Connection&gt;,
 }
<a href="#h6-1-3" id="h6-1-3" class="d">-
</a><a href="#h6-1-4" id="h6-1-4" class="d">-impl DB for SqliteDB {
</a><a href="#h6-1-5" id="h6-1-5" class="d">-    fn new(path: &amp;str) -&gt; Self {
</a><a href="#h6-1-6" id="h6-1-6" class="i">+impl SqliteDB {
</a><a href="#h6-1-7" id="h6-1-7" class="i">+    pub fn new(path: &amp;str) -&gt; Self {
</a>         SqliteDB {
             path: path.to_string(),
             conn: None,
         }
     }
<a href="#h6-1-13" id="h6-1-13" class="d">-
</a><a href="#h6-1-14" id="h6-1-14" class="d">-    fn connect(&amp;mut self) -&gt; Result&lt;(), DatabaseError&gt; {
</a><a href="#h6-1-15" id="h6-1-15" class="i">+}
</a><a href="#h6-1-16" id="h6-1-16" class="i">+impl DB for SqliteDB {
</a><a href="#h6-1-17" id="h6-1-17" class="i">+    fn connect(&amp;mut self) -&gt; Result&lt;(), Error&gt; {
</a>         // Open database connection
         let conn = Connection::open(self.path.clone())?;
         self.conn = Some(conn);
<a href="#h6-2" id="h6-2" class="h">@@ -54,26 +54,26 @@ impl DB for SqliteDB {
</a>         match &amp;self.conn {
             Some(conn) =&gt; match conn.execute(accounts_sql::CREATE_TABLE, []) {
                 Ok(_rows) =&gt; Ok(()),
<a href="#h6-2-3" id="h6-2-3" class="d">-                Err(_err) =&gt; Err(DatabaseError::CreateTableError),
</a><a href="#h6-2-4" id="h6-2-4" class="i">+                Err(_err) =&gt; Err(Error::CreateTable),
</a>             },
<a href="#h6-2-6" id="h6-2-6" class="d">-            None =&gt; Err(DatabaseError::ConnectionError),
</a><a href="#h6-2-7" id="h6-2-7" class="i">+            None =&gt; Err(Error::Connection),
</a>         }
     }
 
<a href="#h6-2-11" id="h6-2-11" class="d">-    fn store_account(&amp;self, account: Account) -&gt; Result&lt;(), DatabaseError&gt; {
</a><a href="#h6-2-12" id="h6-2-12" class="i">+    fn account_store(&amp;self, account: &amp;Account) -&gt; Result&lt;(), Error&gt; {
</a>         match &amp;self.conn {
             Some(conn) =&gt; {
                 conn.execute(
                     accounts_sql::STORE,
<a href="#h6-2-17" id="h6-2-17" class="d">-                    params![account.username, account.password, account.email],
</a><a href="#h6-2-18" id="h6-2-18" class="i">+                    params![&amp;account.username, account.password, account.email],
</a>                 )?;
                 Ok(())
             }
<a href="#h6-2-22" id="h6-2-22" class="d">-            None =&gt; Err(DatabaseError::ConnectionError),
</a><a href="#h6-2-23" id="h6-2-23" class="i">+            None =&gt; Err(Error::Connection),
</a>         }
     }
 
<a href="#h6-2-27" id="h6-2-27" class="d">-    fn get_public_account(&amp;self, username: &amp;str) -&gt; Result&lt;PublicAccount, DatabaseError&gt; {
</a><a href="#h6-2-28" id="h6-2-28" class="i">+    fn account_get_pub(&amp;self, username: &amp;str) -&gt; Result&lt;PublicAccount, Error&gt; {
</a>         match &amp;self.conn {
             Some(conn) =&gt; {
                 let mut stmt = conn.prepare(accounts_sql::GET_PUBLIC)?;
<a href="#h6-3" id="h6-3" class="h">@@ -82,10 +82,10 @@ impl DB for SqliteDB {
</a>                     Some(s) =&gt; Ok(PublicAccount {
                         username: s.get(0)?,
                     }),
<a href="#h6-3-3" id="h6-3-3" class="d">-                    None =&gt; Err(DatabaseError::AccountRetrievalError),
</a><a href="#h6-3-4" id="h6-3-4" class="i">+                    None =&gt; Err(Error::AccountRetrieval),
</a>                 }
             }
<a href="#h6-3-7" id="h6-3-7" class="d">-            None =&gt; Err(DatabaseError::ConnectionError),
</a><a href="#h6-3-8" id="h6-3-8" class="i">+            None =&gt; Err(Error::Connection),
</a>         }
     }
 }
<a href="#h6-4" id="h6-4" class="h">@@ -120,9 +120,9 @@ mod test {
</a>         };
 
         db.connect().unwrap();
<a href="#h6-4-3" id="h6-4-3" class="d">-        db.store_account(account).unwrap();
</a><a href="#h6-4-4" id="h6-4-4" class="i">+        db.account_store(&amp;account).unwrap();
</a> 
<a href="#h6-4-6" id="h6-4-6" class="d">-        let public_account = db.get_public_account(&quot;testuszee&quot;).unwrap();
</a><a href="#h6-4-7" id="h6-4-7" class="i">+        let public_account = db.account_get_pub(&quot;testuszee&quot;).unwrap();
</a> 
         assert_eq!(&amp;public_account.username, &quot;testuszee&quot;);
     }
<b>diff --git a/<a id="h7" href="../file/phora/src/lib.rs.html">phora/src/lib.rs</a> b/<a href="../file/phora/src/lib.rs.html">phora/src/lib.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -1,6 +1,56 @@
</a><a href="#h7-0-0" id="h7-0-0" class="i">+use account::PublicAccount;
</a><a href="#h7-0-1" id="h7-0-1" class="i">+use database::DB;
</a><a href="#h7-0-2" id="h7-0-2" class="i">+
</a> pub mod account;
<a href="#h7-0-4" id="h7-0-4" class="d">-pub mod api;
</a> pub mod crypto;
 pub mod data;
 pub mod database;
 pub mod validate;
<a href="#h7-0-9" id="h7-0-9" class="i">+
</a><a href="#h7-0-10" id="h7-0-10" class="i">+pub struct Cyrtophora&lt;D&gt;
</a><a href="#h7-0-11" id="h7-0-11" class="i">+where
</a><a href="#h7-0-12" id="h7-0-12" class="i">+    D: DB,
</a><a href="#h7-0-13" id="h7-0-13" class="i">+{
</a><a href="#h7-0-14" id="h7-0-14" class="i">+    database: Option&lt;D&gt;,
</a><a href="#h7-0-15" id="h7-0-15" class="i">+}
</a><a href="#h7-0-16" id="h7-0-16" class="i">+
</a><a href="#h7-0-17" id="h7-0-17" class="i">+impl&lt;D: DB&gt; Cyrtophora&lt;D&gt; {
</a><a href="#h7-0-18" id="h7-0-18" class="i">+    #[cfg(feature = &quot;sqlite&quot;)]
</a><a href="#h7-0-19" id="h7-0-19" class="i">+    pub fn new(path: &amp;str) -&gt; Result&lt;Self, database::error::Error&gt; {
</a><a href="#h7-0-20" id="h7-0-20" class="i">+        let mut db = database::sqlite::SqliteDB::new(path);
</a><a href="#h7-0-21" id="h7-0-21" class="i">+        db.connect()?;
</a><a href="#h7-0-22" id="h7-0-22" class="i">+        let c = Cyrtophora { database: Some(db) };
</a><a href="#h7-0-23" id="h7-0-23" class="i">+        Ok(c)
</a><a href="#h7-0-24" id="h7-0-24" class="i">+    }
</a><a href="#h7-0-25" id="h7-0-25" class="i">+
</a><a href="#h7-0-26" id="h7-0-26" class="i">+    /// Create a new account
</a><a href="#h7-0-27" id="h7-0-27" class="i">+    pub fn account_create(
</a><a href="#h7-0-28" id="h7-0-28" class="i">+        &amp;mut self,
</a><a href="#h7-0-29" id="h7-0-29" class="i">+        payload: data::AccountCreationInput,
</a><a href="#h7-0-30" id="h7-0-30" class="i">+    ) -&gt; Result&lt;PublicAccount, Box&lt;dyn std::error::Error&gt;&gt; {
</a><a href="#h7-0-31" id="h7-0-31" class="i">+        let account = account::Account::create(payload)?;
</a><a href="#h7-0-32" id="h7-0-32" class="i">+        // TODO: email verification
</a><a href="#h7-0-33" id="h7-0-33" class="i">+
</a><a href="#h7-0-34" id="h7-0-34" class="i">+        // store account in database
</a><a href="#h7-0-35" id="h7-0-35" class="i">+        if cfg!(sqlite) {
</a><a href="#h7-0-36" id="h7-0-36" class="i">+            if let Some(db) = &amp;self.database {
</a><a href="#h7-0-37" id="h7-0-37" class="i">+                db.account_store(&amp;account)?;
</a><a href="#h7-0-38" id="h7-0-38" class="i">+            }
</a><a href="#h7-0-39" id="h7-0-39" class="i">+        }
</a><a href="#h7-0-40" id="h7-0-40" class="i">+        Ok(account.into())
</a><a href="#h7-0-41" id="h7-0-41" class="i">+    }
</a><a href="#h7-0-42" id="h7-0-42" class="i">+
</a><a href="#h7-0-43" id="h7-0-43" class="i">+    /// Get account public data, using the username as ID
</a><a href="#h7-0-44" id="h7-0-44" class="i">+    pub fn account_get(&amp;self, username: &amp;str) -&gt; Result&lt;PublicAccount, database::error::Error&gt; {
</a><a href="#h7-0-45" id="h7-0-45" class="i">+        if cfg!(sqlite) {
</a><a href="#h7-0-46" id="h7-0-46" class="i">+            if let Some(db) = &amp;self.database {
</a><a href="#h7-0-47" id="h7-0-47" class="i">+                let public_account = db.account_get_pub(username)?;
</a><a href="#h7-0-48" id="h7-0-48" class="i">+                Ok(public_account)
</a><a href="#h7-0-49" id="h7-0-49" class="i">+            } else {
</a><a href="#h7-0-50" id="h7-0-50" class="i">+                Err(database::error::Error::Connection)
</a><a href="#h7-0-51" id="h7-0-51" class="i">+            }
</a><a href="#h7-0-52" id="h7-0-52" class="i">+        } else {
</a><a href="#h7-0-53" id="h7-0-53" class="i">+            Err(database::error::Error::Connection)
</a><a href="#h7-0-54" id="h7-0-54" class="i">+        }
</a><a href="#h7-0-55" id="h7-0-55" class="i">+    }
</a><a href="#h7-0-56" id="h7-0-56" class="i">+}
</a><b>diff --git a/<a id="h8" href="../file/spec/book.toml.html">spec/book.toml</a> b/<a href="../file/spec/book.toml.html">spec/book.toml</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -3,4 +3,4 @@ authors = [&quot;Jackson G. Kaindume&quot;]
</a> language = &quot;en&quot;
 multilingual = false
 src = &quot;src&quot;
<a href="#h8-0-3" id="h8-0-3" class="d">-title = &quot;cyrtophora&quot;
</a><a href="#h8-0-4" id="h8-0-4" class="i">+title = &quot;Cyber Defense&quot;
</a><b>diff --git a/<a id="h9" href="../file/spec/src/SUMMARY.md.html">spec/src/SUMMARY.md</a> b/<a href="../file/spec/src/SUMMARY.md.html">spec/src/SUMMARY.md</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -5,3 +5,4 @@
</a> - [Database](./database.md)
   - [SQLite Support](./sqlite-support.md)
   - [Password-hashing](./password-hashing.md)
<a href="#h9-0-3" id="h9-0-3" class="i">+- [Validation](./validation.md)
</a><b>diff --git a/<a id="h10" href="../file/spec/src/cyrtophora.md.html">spec/src/cyrtophora.md</a> b/<a href="../file/spec/src/cyrtophora.md.html">spec/src/cyrtophora.md</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -1,3 +1,3 @@
</a> # Cyrtophora
 
<a href="#h10-0-2" id="h10-0-2" class="d">-Full-stack users-first web framework.
</a><a href="#h10-0-3" id="h10-0-3" class="i">+Full-stack users-first, secure web framework.
</a><b>diff --git a/<a id="h11" href="../file/spec/src/password-hashing.md.html">spec/src/password-hashing.md</a> b/<a href="../file/spec/src/password-hashing.md.html">spec/src/password-hashing.md</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -69,3 +69,7 @@ password hash functions are used and implemented correctly even the
</a> administrators of the server will not be able to read the users 
 passwords especially if the server is open source and the users can
 audit the code for themselves.
<a href="#h11-0-3" id="h11-0-3" class="i">+
</a><a href="#h11-0-4" id="h11-0-4" class="i">+&lt;https://www.troyhunt.com/our-password-hashing-has-no-clothes/&gt;
</a><a href="#h11-0-5" id="h11-0-5" class="i">+&lt;https://paragonie.com/blog/2016/02/how-safely-store-password-in-2016&gt;
</a><a href="#h11-0-6" id="h11-0-6" class="i">+&lt;https://www.troyhunt.com/passwords-evolved-authentication-guidance-for-the-modern-era/&gt;
</a><b>diff --git a/<a id="h12" href="../file/spec/src/validation.md.html">spec/src/validation.md</a> b/<a href="../file/spec/src/validation.md.html">spec/src/validation.md</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -0,0 +1 @@
</a><a href="#h12-0-0" id="h12-0-0" class="i">+&lt;https://beesbuzz.biz/code/439-Falsehoods-programmers-believe-about-email&gt;
</a></pre>
</div>
</body>
</html>
